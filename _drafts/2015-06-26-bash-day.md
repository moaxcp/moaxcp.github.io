---
published: false
---

Digging deeper into bash can be rewarding. Today, and possibly this weekend, I am going to focus on getting bash looking good.

##PS1
In a [previous post](http://moaxcp.github.io/2015/04/15/ps1-in-gentoo.html) I wrote about changing the directory output using \W instead of \w. This helps shorten the prompt when working in deep directories. Today I found [this](https://wiki.archlinux.org/index.php/Color_Bash_Prompt) wiki page which shows how to add the output of the previous command to the prompt for debugging.

Every program that completes needs to return a status code. 0 means everything is ok, non-0 means something went wrong. Adding this to PS1 is great for testing commands like `grep -q` before adding it to a script. I setup the output with the green check box for 0 and red x for non-0.

In gentoo, this causes problems. My prompt shows a red and green box instead of the check box and x. Since these are unicode characters and xterm can be built without unicode support, the first thing I checked is the use flags.

    john-gentoo john # emerge -av xterm

     * IMPORTANT: 2 news items need reading for repository 'gentoo'.
     * Use eselect news read to view new items.
     
    These are the packages that would be merged, in order:

    Calculating dependencies... done!
    [ebuild   R    ] x11-terms/xterm-314::gentoo  USE="openpty truetype unicode -Xaw3d -toolbar" 0 KiB

    Total: 1 package (1 reinstall), Size of downloads: 0 KiB

    Would you like to merge these packages? [Yes/No] 
    
This shows that tmux was built with the unicode use flag turned on so the problem is not xterm.

On [this](https://wiki.gentoo.org/wiki/UTF-8) guide I found this:
> It is wise to add unicode to the global USE flags in /etc/portage/make.conf

And now I am performing an emerge and sync.


